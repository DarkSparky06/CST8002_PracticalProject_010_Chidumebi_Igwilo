// Main.java
// CST8002 – Practical Project 1
// Prof. Stanley Pedia, Due May25
// Author: Chidumebi Igwilo
//
// Data source attribution (Open Government Licence – Canada):
// Canadian Food Inspection Agency. (2023-05-12).
// 2013-14 Coumarin in dried beverage mixes, breads, baking mixes, spice mixes,
// dried tea, baked goods, and breakfast foods.
// open.canada.ca/data/en/dataset/c3675987-71ae-493c-b9be-c2222301ce4f

import com.opencsv.CSVReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.List;

public class Main {
    public static void main(String[] args) {
        System.out.println("Chidumebi Igwilo");  // Always visible
        System.out.println("")

        String csvFile = "coumarin.csv";
        List<CoumarinRecord> records = new ArrayList<>();

        // Phase 1: Open and read the CSV
        try (CSVReader reader = new CSVReader(new FileReader(csvFile))) {
            // Skip header line(s)
            reader.readNext(); // English header
            // If there's a French header line, uncomment the next:
            // reader.readNext();

            String[] line;
            while ((line = reader.readNext()) != null) {
                // Detect empty strings and convert to null
                for (int i = 0; i < line.length; i++) {
                    if (line[i].trim().isEmpty()) {
                        line[i] = null;
                    }
                }
                CoumarinRecord rec = new CoumarinRecord(
                    line[0], line[1], line[2], line[3],
                    line[4], line[5], line[6], line[7],
                    line[8], line[9]
                );
                records.add(rec);
            }
        } catch (FileNotFoundException e) {
            System.err.println("ERROR: CSV file not found: " + csvFile);
            return;
        } catch (IOException e) {
            e.printStackTrace();
            return;
        }

        // Phase 2: Loop over and display
        for (CoumarinRecord r : records) {
            System.out.println(r);
        }
    }
}
